<html>
<head>
	<title>RaspberryPi Car Concrol</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript">
var xmlhttp;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
	xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
	xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
function send(){
	var a=document.getElementById("motor").value;
	var b=document.getElementById("servo").value;
	//document.getElementById("myDiv").innerHTML=a+b;
	xmlhttp.open("GET","/change.cgi?"+a+"&"+b,true);
	xmlhttp.send();
}
</script>
</head>
<body>
<div id="myDiv"><h3>Let AJAX change this text</h3></div>
<input type="text" id="motor"><br>
<input type="text" id="servo"><br>
<button type="button" onclick="send()">Send</button>
<div id="test" style="font-size:12px;-webkit-text-size-adjust:none;margin:6px;">xixi!</div>
<script defer>

function Orientation(selector) {



}



Orientation.prototype.init = function(){

	window.addEventListener('deviceorientation', this.orientationListener, false);

	window.addEventListener('MozOrientation', this.orientationListener, false);

	window.addEventListener('devicemotion', this.orientationListener, false);

}



Orientation.prototype.orientationListener = function(evt) {

	// For FF3.6+

	if (!evt.gamma && !evt.beta) {

		// angle=radian*180.0/PI 在firefox中x和y是弧度值,

		evt.gamma = (evt.x * (180 / Math.PI)); //转换成角度值,

		evt.beta = (evt.y * (180 / Math.PI)); //转换成角度值

		evt.alpha = (evt.z * (180 / Math.PI)); //转换成角度值

	}

	/* beta:  -180..180 (rotation around x axis) */

	/* gamma:  -90..90  (rotation around y axis) */

	/* alpha:    0..360 (rotation around z axis) (-180..180) */



	var gamma = evt.gamma

		var beta = evt.beta

		var alpha = evt.alpha



		if(evt.accelerationIncludingGravity){

			// window.removeEventListener('deviceorientation', this.orientationListener, false);

			gamma = event.accelerationIncludingGravity.x*10

				beta = -event.accelerationIncludingGravity.y*10

				alpha = event.accelerationIncludingGravity.z*10

		}







	if (this._lastGamma != gamma || this._lastBeta != beta) {

		document.getElementById("test").innerHTML = "x: "+ beta.toFixed(2) + " y: " + gamma.toFixed(2) + " z: " + (alpha != null?alpha.toFixed(2):0)


		this._lastGamma = gamma;

		this._lastBeta = beta;

	}

};

(new Orientation()).init();

</script>

</body>
</html>
