<html>
<head>
<script type="text/javascript">
var xmlhttp;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
	    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
	    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}

</script>

</head>
<body>
<div>
<h2>Device Orientation</h2>
<table>
<tr>
<td>Event Supported</td>
<td id="doEvent"></td>
</tr>
<tr>
<td>Tilt Left/Right [gamma]</td>
<td id="doTiltLR"></td>
</tr>
<tr>
<td>Tilt Front/Back [beta]</td>
<td id="doTiltFB"></td>
</tr>
<tr>
<td>Direction [alpha]</td>
<td id="doDirection"></td>
</tr>
</table>
</div>
<script type="text/javascript">
init();
var count=0;
var a=0;	//0-4000  0-2000:backward 2000-4000:forward
var b=150;	//50-250
function init(){
	if(window.DeviceOrientationEvent){
		document.getElementById("doEvent").innerHTML="DeviceOrientation";
		window.addEventListener(
				'deviceorientation',
				function(eventData){
					var tiltLR=eventData.gamma;
					var tiltFB=eventData.beta;
					var dir=eventData.alpha
					deviceOrientationHandler(tiltLR,tiltFB,dir);
					a=Math.round((tiltLR+90)*400/9+2000); 
					b=Math.round(tiltFB*10/9+150);
					//sendcmd();
				},
				false);
	}
	else{
		document.getElementById("doEvent").innerHTML="Not supported on your device or browser.  Sorry."
	}
}
function deviceOrientationHandler(tiltLR,tiltFB,dir){
	document.getElementById("doTiltLR").innerHTML=Math.round(tiltLR);
	document.getElementById("doTiltFB").innerHTML=Math.round(tiltFB);
	document.getElementById("doDirection").innerHTML=Math.round(dir);
}
function sendcmd(){
	xmlhttp.open("GET","/change.cgi?"+a+"&"+b,true);
	xmlhttp.send();
}
setInterval(sendcmd,100)
</script>
</body>
</html>
